<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:p="http://primefaces.org/ui"
	xmlns:f="http://xmlns.jcp.org/jsf/core"
	xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
	template="/templates/Layout.xhtml">

	<ui:define name="conteudo">

		<h:form id="formMensagem">
			<p:messages id="mensagem" closable="true" />
		</h:form>

		<h:form id="header">
			<h:panelGrid>

				<h:outputText styleClass="h1" value="FUNCIONARIO - 1" />
				<h:form id="formMsg">
					<p:messages id="msg" closable="true" />
				</h:form>

			</h:panelGrid>
		</h:form>

		<h:form id="formListagem">
		
			<p:dataTable id="tableListagem" paginator="true" reflow="true"
				widgetVar="tableListage" rowsPerPageTemplate="2,4,6"
				value="#{beanParticipanteCRUD.participantes}" var="participante"
				filteredValue="#{beanParticipanteCRUD.participantesFiltrados}"
				emptyMessage="Nenhum registro encontrado." rows="4">

				<f:facet name="header">
					<p:outputPanel>
						<h:outputText value="Pesquisa:" />
						<p:inputText id="globalFilter"
							onkeyup="PF('tableListage').filter()"
							onchange=""/>
					</p:outputPanel>
				</f:facet>

				<p:column headerText="Nome" filterBy="#{participante.nome}"
					filterable="false" sortBy="#{participante.nome}">
					<h:outputText value="#{participante.nome}" />
				</p:column>

				<p:column headerText="Area de Interesse"
					filterBy="#{participante.areaDeInteresse}" filterable="false">
					<h:outputText value="#{participante.areaDeInteresse}" />
				</p:column>

				<p:column headerText="Curso" filterBy="#{participante.curso}"
					filterable="false">
					<h:outputText value="#{participante.curso}" />
				</p:column>

				<p:column headerText="Estudante Facisa?"
					sortBy="#{participante.estudanteFacisa}"
					filterBy="#{participante.estudanteFacisa}" filterable="false">
					<h:outputText value="#{participante.estudanteFacisa}"
						disabled="true" />
				</p:column>

				<p:column headerText="Celular" sortBy="#{participante.celular}"
					filterBy="#{participante.celular}" filterable="false">
					<h:outputText value="#{participante.celular}">
						<f:convertNumber pattern="(99)99999-9999"></f:convertNumber>
					</h:outputText>
				</p:column>

				<p:column headerText="Email" sortBy="#{participante.email}"
					filterBy="#{participante.email}" filterable="false">
					<h:outputText value="#{participante.email}" />
				</p:column>

				<p:column headerText="Opções">

					<p:commandButton id="excluir" icon="ui-icon-trash" styleClass="botao-excluir"
						actionListener="#{beanParticipanteCRUD.excluir}"
						update=":formMensagem:mensagem, :formListagem:tableListagem">
						<p:confirm header="Confirmação"
							message="Deseja realmente excluir este participante?"
							icon="ui-icon-alert" />
						<f:attribute name="selecionadoCorrente" value="#{participante}" />
					</p:commandButton>

					<p:commandButton icon="ui-icon-pencil" styleClass="botao-editar"
						actionListener="#{beanParticipanteCRUD.editar}"
						oncomplete="PF('edicao').show();"
						update=":formMensagem:mensagem, :formListagem:tableListagem, :formEdicao">
						<f:actionListener
							type="org.omnifaces.eventlistener.ResetInputAjaxActionListener" />

						<f:attribute name="selecionadoCorrente" value="#{participante}" />
					</p:commandButton>

					<p:commandButton icon="ui-icon-search" styleClass="botao-editar"
						actionListener="#{beanParticipanteCRUD.editar}"
						oncomplete="PF('visualizar').show();"
						update=":formMensagem:mensagem, :formListagem:tableListagem, :formVisualizar">
						<f:actionListener
							type="org.omnifaces.eventlistener.ResetInputAjaxActionListener" />

						<f:attribute name="selecionadoCorrente" value="#{participante}" />
					</p:commandButton>


				</p:column>

			</p:dataTable>
		</h:form>

		<h:form styleClass="botoes-crud">
			<p:commandButton value="NOVO" styleClass="botao-novo"
				actionListener="#{beanParticipanteCRUD.instanciarNovo}"
				oncomplete="PF('cadastro').show();" update=":formCadastro">
				<f:actionListener
					type="org.omnifaces.eventlistener.ResetInputAjaxActionListener" />
			</p:commandButton>

		</h:form>

		<h:form>
			<p:confirmDialog global="true" showEffect="fade" hideEffect="fade">
				<p:commandButton value="Sim" type="button"
					styleClass="ui-confirmdialog-yes" icon="ui-icon-check" />
				<p:commandButton value="Não" type="button"
					styleClass="ui-confirmdialog-no" icon="ui-icon-close" />
			</p:confirmDialog>
		</h:form>

		<!-- DIALOG CADASTRO -->

		<p:dialog header="Cadastro - Participante" widgetVar="cadastro"
			appendTo="@(body)" id="cadastroDialog" modal="true" closable="false"
			hideEffect="fade" responsive="true" resizable="false">

			<h:form id="formCadastro">
				<p:messages id="mensagemCadastro" />
				<h:panelGrid id="painel">
					<h:panelGrid columns="2">

						<p:outputLabel for="nome" value="Nome:" />
						<p:inputText size="50" maxlength="50" id="nome"
							value="#{beanParticipanteCRUD.participante.nome}" required="true"
							requiredMessage="O campo nome é um campo obrigatório" />

						<p:outputLabel for="area" value="Area de Interesse" />
						<p:selectOneMenu id="area"
							converter="omnifaces.SelectItemsConverter"
							value="#{beanParticipanteCRUD.participante.areaDeInteresse}"
							required="true"
							requiredMessage="O campo 'Área de interesse' é um campo obrigatório">
							<f:selectItem noSelectionOption="true" itemLabel="Selecione" />
							<f:selectItems
								value="#{beanParticipanteCRUD.listaAreasInteresse}" var="area"
								itemValue="#{area}" itemLabel="#{area}" />
						</p:selectOneMenu>



						<p:outputLabel value="Estudante Facisa?:" />
						<p:selectOneRadio
							value="#{beanParticipanteCRUD.participante.estudanteFacisa}"
							required="true"
							requiredMessage="O campo 'Estudante Facisa?' é um campo obrigatório">
							<f:selectItem itemValue="S" itemLabel="SIM" />
							<f:selectItem itemValue="N" itemLabel="NÃO" />
							<f:selectItem itemValue="J" itemLabel="JÁ CONCLUI" />
							<p:ajax listener="#{beanParticipanteCRUD.EalunoFacisa()}"
								update=":formCadastro:dadosEstudante" />
						</p:selectOneRadio>
					</h:panelGrid>


					<h:panelGrid columns="2" id="dadosEstudante">

						<p:outputLabel id="matricula" for="matriculaIn"
							value="Num da Matricula"
							rendered="#{beanParticipanteCRUD.EalunoFacisa()}" />
						<p:inputText id="matriculaIn" size="15" maxlength="10"
							rendered="#{beanParticipanteCRUD.EalunoFacisa()}"
							value="#{beanParticipanteCRUD.participante.matricula}"
							required="true"
							requiredMessage="O campo matricula é um campo obrigatório" />

						<p:outputLabel for="cur" value="Curso"
							rendered="#{beanParticipanteCRUD.EalunoFacisa()}" />
						<p:selectOneMenu id="cur" maxlength="30"
							rendered="#{beanParticipanteCRUD.EalunoFacisa()}"
							converter="omnifaces.SelectItemsConverter"
							value="#{beanParticipanteCRUD.participante.curso}"
							required="true"
							requiredMessage="O campo curso é um campo obrigatório">
							<f:selectItem noSelectionOption="true" itemLabel="Selecione" />
							<f:selectItems value="#{beanParticipanteCRUD.listaDeCursos}"
								var="curso" itemValue="curso" itemLabel="curso" />
						</p:selectOneMenu>

						<p:outputLabel for="per" value="Periodo"
							rendered="#{beanParticipanteCRUD.EalunoFacisa()}" />
						<p:selectOneMenu id="per" maxlength="30"
							rendered="#{beanParticipanteCRUD.EalunoFacisa()}"
							converter="omnifaces.SelectItemsConverter"
							value="#{beanParticipanteCRUD.participante.periodo}"
							required="true"
							requiredMessage="O campo periodo é um campo obrigatório">
							<f:selectItem noSelectionOption="true" itemLabel="Selecione" />
							<f:selectItems value="#{beanParticipanteCRUD.listaPeriodos}"
								var="periodo" itemValue="periodo" itemLabel="periodo" />
						</p:selectOneMenu>

					</h:panelGrid>

					<h:panelGrid columns="2" id="contato">

						<p:outputLabel for="tel" value="Celular com DDD" />
						<p:inputMask mask="(99)99999-9999" maxlength="15" id="tel"
							value="#{beanParticipanteCRUD.participante.celular}"
							required="true"
							requiredMessage="O campo Celular é um campo obrigatório" />

						<p:outputLabel for="res" value="Residencial" />
						<p:inputMask mask="(99)9999-9999" maxlength="15" id="res"
							value="#{beanParticipanteCRUD.participante.telefone}"
							required="true"
							requiredMessage="O campo residencial é um campo obrigatório" />

						<p:outputLabel for="email" value="Email:" />
						<p:inputText size="50" maxlength="50" id="email"
							value="#{beanParticipanteCRUD.participante.email}"
							required="true"
							requiredMessage="O campo 'Email' é um campo obrigatório"
							validatorMessage="O campo 'Email' não é valido">
							<f:validator validatorId="custom.emailValidator" />
						</p:inputText>
						<p:outputLabel for="site" value="Site:" />
						<p:inputText size="50" maxlength="50" id="site"
							value="#{beanParticipanteCRUD.participante.site}" />


					</h:panelGrid>


				</h:panelGrid>

				<h:panelGrid columns="2">
					<p:commandButton value="Salvar"
						actionListener="#{beanParticipanteCRUD.salvar}"
						update=":formCadastro:mensagemCadastro, :formListagem:tableListagem, :formCadastro"
						onsuccess="setTimeout ('$(\'#formCadastro\\\\:mensagemCadastro\').hide()', 4000);" />
					<p:commandButton value="Cancelar"
						oncomplete="PF('cadastro').hide();" />
				</h:panelGrid>
			</h:form>
		</p:dialog>


		<!-- EDIÇAO DIALOGO -->

		<p:dialog header="Editar - Pessoa" widgetVar="edicao"
			appendTo="@(body)" id="edicaoDialog" modal="true" closable="false"
			draggable="false" responsive="true" resizable="false">

			<h:form id="formEdicao">
				<p:messages id="mensagemEdicao" />
				<h:panelGrid id="painel">
					<h:panelGrid columns="2">

						<p:outputLabel for="nome" value="Nome:" />
						<p:inputText size="50" maxlength="50" id="nome"
							value="#{beanParticipanteCRUD.participante.nome}" required="true"
							requiredMessage="O campo nome é um campo obrigatório" />

						<p:outputLabel for="area" value="Area de Interesse" />
						<p:selectOneMenu id="area"
							converter="omnifaces.SelectItemsConverter"
							value="#{beanParticipanteCRUD.participante.areaDeInteresse}"
							required="true"
							requiredMessage="O campo 'Área de interesse' é um campo obrigatório">
							<f:selectItem noSelectionOption="true" itemLabel="Selecione" />
							<f:selectItems
								value="#{beanParticipanteCRUD.listaAreasInteresse}" var="area"
								itemValue="#{area}" itemLabel="#{area}" />
						</p:selectOneMenu>

						<p:outputLabel value="Estudante Facisa?:" />
						<p:selectOneRadio
							value="#{beanParticipanteCRUD.participante.estudanteFacisa}"
							required="true"
							requiredMessage="O campo 'Estudante Facisa?' é um campo obrigatório">
							<f:selectItem itemValue="S" itemLabel="SIM" />
							<f:selectItem itemValue="N" itemLabel="NÃO" />
							<p:ajax listener="#{beanParticipanteCRUD.EalunoFacisa()}"
								update=":formEdicao" />

						</p:selectOneRadio>

						<p:outputLabel id="matricula" for="matriculaIn" value="Matricula:"
							rendered="#{beanParticipanteCRUD.EalunoFacisa()}" />
						<p:inputText id="matriculaIn" size="15" maxlength="10"
							rendered="#{beanParticipanteCRUD.EalunoFacisa()}"
							value="#{beanParticipanteCRUD.participante.matricula}"
							required="true"
							requiredMessage="O campo 'Matricula' é um campo obrigatório" />

						<p:outputLabel for="cur" value="Curso"
							rendered="#{beanParticipanteCRUD.EalunoFacisa()}" />
						<p:selectOneMenu id="cur" maxlength="30"
							rendered="#{beanParticipanteCRUD.EalunoFacisa()}"
							converter="omnifaces.SelectItemsConverter"
							value="#{beanParticipanteCRUD.participante.curso}"
							required="true"
							requiredMessage="O campo 'Curso' é um campo obrigatório">
							<f:selectItem noSelectionOption="true" itemLabel="Selecione" />
							<f:selectItems value="#{beanParticipanteCRUD.listaDeCursos}"
								var="curso" itemValue="curso" itemLabel="curso" />
						</p:selectOneMenu>

						<p:outputLabel for="per" value="Periodo"
							rendered="#{beanParticipanteCRUD.EalunoFacisa()}" />
						<p:selectOneMenu id="per" maxlength="30"
							rendered="#{beanParticipanteCRUD.EalunoFacisa()}"
							converter="omnifaces.SelectItemsConverter"
							value="#{beanParticipanteCRUD.participante.periodo}"
							required="true"
							requiredMessage="O campo curso é um 'Periodo' obrigatório">
							<f:selectItem noSelectionOption="true" itemLabel="Selecione" />
							<f:selectItems value="#{beanParticipanteCRUD.listaPeriodos}"
								var="periodo" itemValue="periodo" itemLabel="periodo" />
						</p:selectOneMenu>

						<p:outputLabel for="tel" value="Celular" />
						<p:inputMask mask="(99)99999-9999" maxlength="15" id="tel"
							value="#{beanParticipanteCRUD.participante.celular}"
							required="true"
							requiredMessage="O campo 'Celular' é um campo obrigatório" />

						<p:outputLabel for="res" value="Residencial" />
						<p:inputMask mask="(99)9999-9999" maxlength="15" id="res"
							value="#{beanParticipanteCRUD.participante.telefone}"
							required="true"
							requiredMessage="O campo 'Residencial' é um campo obrigatório" />

						<p:outputLabel for="email" value="Email:" />
						<p:inputText size="50" maxlength="50" id="email"
							value="#{beanParticipanteCRUD.participante.email}"
							required="true"
							requiredMessage="O campo 'Email' é um campo obrigatório"
							validatorMessage="O campo 'Email' não é valido">
							<f:validator validatorId="custom.emailValidator" />
						</p:inputText>
						<p:outputLabel for="site" value="Site:" />
						<p:inputText size="50" maxlength="50" id="site"
							value="#{beanParticipanteCRUD.participante.site}" />


					</h:panelGrid>


				</h:panelGrid>

				<h:panelGrid columns="2">
					<p:commandButton value="Salvar"
						actionListener="#{beanParticipanteCRUD.salvar}"
						icon="ui-icon-check" validateClient="true"
						update=":formEdicao:mensagemEdicao, :formListagem:tableListagem, :formEdicao"
						onsuccess="setTimeout ( '$(\'#formCadastro\\\\:mensagemCadastro\').hide()', 4000);" />
					<p:commandButton value="Cancelar" oncomplete="PF('edicao').hide();" />
				</h:panelGrid>
			</h:form>
		</p:dialog>

		<!-- EDIÇAO VISUALIZAÇÃO -->

		<p:dialog header="Visualizar - Pessoa" widgetVar="visualizar"
			appendTo="@(body)" id="visualizarDialog" modal="true"
			closable="false" draggable="false" responsive="true"
			resizable="false">

			<h:form id="formVisualizar">
				<p:messages id="mensagemVisualizar" />
				<h:panelGrid id="painel">
					<h:panelGrid columns="2">

						<p:outputLabel for="nome" value="Nome:" />
						<p:inputText size="50" maxlength="50" id="nome"
							value="#{beanParticipanteCRUD.participante.nome}" disabled="true" />


						<p:outputLabel for="area" value="Area de Interesse" />
						<p:selectOneMenu id="area"
							converter="omnifaces.SelectItemsConverter" disabled="true"
							value="#{beanParticipanteCRUD.participante.areaDeInteresse}">
							<f:selectItem noSelectionOption="true" itemLabel="Selecione" />
							<f:selectItems
								value="#{beanParticipanteCRUD.listaAreasInteresse}" var="area"
								itemValue="#{area}" itemLabel="#{area}" />
						</p:selectOneMenu>

						<p:outputLabel value="Estudante Facisa?:" />
						<p:selectOneRadio disabled="true"
							value="#{beanParticipanteCRUD.participante.estudanteFacisa}">
							<f:selectItem itemValue="S" itemLabel="SIM" />
							<f:selectItem itemValue="N" itemLabel="NÃO" />
							<p:ajax listener="#{beanParticipanteCRUD.EalunoFacisa()}"
								update=":formVisualizar" />
						</p:selectOneRadio>

						<p:outputLabel id="matricula" for="matriculaIn" value="Matricula:"
							rendered="#{beanParticipanteCRUD.EalunoFacisa()}" />
						<p:inputText id="matriculaIn" size="15" maxlength="10"
							disabled="true" rendered="#{beanParticipanteCRUD.EalunoFacisa()}"
							value="#{beanParticipanteCRUD.participante.matricula}"
							required="true"
							requiredMessage="O campo matricula é um campo obrigatório" />

						<p:outputLabel for="cur" value="Curso"
							rendered="#{beanParticipanteCRUD.EalunoFacisa()}" />
						<p:selectOneMenu id="cur" maxlength="30" disabled="true"
							rendered="#{beanParticipanteCRUD.EalunoFacisa()}"
							converter="omnifaces.SelectItemsConverter"
							value="#{beanParticipanteCRUD.participante.curso}"
							required="true"
							requiredMessage="O campo curso é um campo obrigatório">
							<f:selectItem noSelectionOption="true" itemLabel="Selecione" />
							<f:selectItems value="#{beanParticipanteCRUD.listaDeCursos}"
								var="curso" itemValue="curso" itemLabel="curso" />
						</p:selectOneMenu>

						<p:outputLabel for="per" value="Periodo"
							rendered="#{beanParticipanteCRUD.EalunoFacisa()}" />
						<p:selectOneMenu id="per" maxlength="30" disabled="true"
							rendered="#{beanParticipanteCRUD.EalunoFacisa()}"
							converter="omnifaces.SelectItemsConverter"
							value="#{beanParticipanteCRUD.participante.periodo}"
							required="true"
							requiredMessage="O campo curso é um periodo obrigatório">
							<f:selectItem noSelectionOption="true" itemLabel="Selecione" />
							<f:selectItems value="#{beanParticipanteCRUD.listaPeriodos}"
								var="periodo" itemValue="periodo" itemLabel="periodo" />
						</p:selectOneMenu>

						<p:outputLabel for="tel" value="Celular" />
						<p:inputMask mask="(99)99999-9999" maxlength="15" id="tel"
							disabled="true"
							value="#{beanParticipanteCRUD.participante.celular}"
							required="true"
							requiredMessage="O campo Celular é um campo obrigatório" />

						<p:outputLabel for="res" value="Residencial" />
						<p:inputMask mask="(99)9999-9999" maxlength="15" id="res"
							disabled="true"
							value="#{beanParticipanteCRUD.participante.telefone}" />

						<p:outputLabel for="email" value="Email:" />
						<p:inputText size="50" maxlength="50" id="email" disabled="true"
							value="#{beanParticipanteCRUD.participante.email}"
							required="true"
							requiredMessage="O campo 'Email' é um campo obrigatório"
							validatorMessage="O campo 'Email' não é valido">
							<f:validator validatorId="custom.emailValidator" />
						</p:inputText>
						<p:outputLabel for="site" value="Site:" />
						<p:inputText size="50" maxlength="50" id="site" disabled="true"
							value="#{beanParticipanteCRUD.participante.site}" />


					</h:panelGrid>


				</h:panelGrid>

				<h:panelGrid columns="2">
					<p:commandButton value="Fechar"
						oncomplete="PF('visualizar').hide();" />
				</h:panelGrid>
			</h:form>
		</p:dialog>

		<script type="text/javascript">
    /**
     * Faces Validator
     */
    PrimeFaces.validator['custom.emailValidator'] = {
 
        pattern: /\S+@\S+/,
 
        validate: function(element, value) {
            //use element.data() to access validation metadata, in this case there is none.
            if(!this.pattern.test(value)) {
                throw {
                    summary: 'Validation Error',
                    detail: value + ' is not a valid email.'
                }
            }
        }
    };
 
</script>


	</ui:define>
</ui:composition>