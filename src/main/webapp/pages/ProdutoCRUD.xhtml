<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:p="http://primefaces.org/ui"
	xmlns:f="http://xmlns.jcp.org/jsf/core"
	xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
	template="/templates/header-menu-conteudo-vertical.xhtml">

	<ui:define name="conteudo">

		<p:panel header="PRODUTO">
			<h:form id="formMensagem">
				<p:messages id="mensagem" closable="true" />
			</h:form>
			<h:form id="formListagem">
				<p:dataTable id="tableListagem" paginator="true"
					widgetVar="tableListagem" value="#{beanProdutoCRUD.produtos}"
					var="produto" filteredValue="#{beanProdutoCRUD.produtosFiltrados}"
					emptyMessage="Nenhum registro encontrado." rows="8">
					<f:facet name="header">
						<h:panelGrid columns="2" style="border: none !important;">
							<p:commandButton value="NOVO"
								actionListener="#{beanProdutoCRUD.instanciarNovo}"
								update=":formCadastro" oncomplete="PF('cadastro').show();">
								<f:actionListener
									type="org.omnifaces.eventlistener.ResetInputAjaxActionListener" />
							</p:commandButton>
							<p:outputPanel>
								<p:outputLabel for="globalFilter" value="Pesquisar: " />
								<p:inputText id="globalFilter"
									onkeyup="PF('tableListagem').filter()" style="width:150px" />
							</p:outputPanel>
						</h:panelGrid>
					</f:facet>

					<p:column headerText="Descrição" sortBy="#{produto.descricao}">
						<h:outputText value="#{produto.descricao}" />
					</p:column>

					<p:column headerText="Quantidade" sortBy="#{produto.quantidade}">
						<h:outputText value="#{produto.quantidade}" />
					</p:column>

					<p:column headerText="Preço" sortBy="#{produto.preco}">
						<h:outputText value="#{produto.preco}">
							<f:convertNumber locale="pt_BR" minFractionDigits="2" />
						</h:outputText>

					</p:column>

					<p:column headerText="Fabricante"
						sortBy="#{produto.fabricante.descricao}">
						<h:outputText value="#{produto.fabricante.descricao}" />
					</p:column>



					<p:column headerText="Opções">
						<p:panelGrid columns="4">
							<p:commandLink value="Alterar"
								actionListener="#{beanProdutoCRUD.editar}"
								oncomplete="PF('edicao').show();"
								update=":formMensagem:mensagem, :formListagem:tableListagem, :formEdicao">
								<f:actionListener
									type="org.omnifaces.eventlistener.ResetInputAjaxActionListener" />

								<f:attribute name="selecionadoCorrente" value="#{produto}" />
							</p:commandLink>

							<p:commandLink value="Copiar" disabled="true" />

							<p:commandLink value="Excluir"
								actionListener="#{beanProdutoCRUD.excluir}"
								update=":formMensagem:mensagem, :formListagem:tableListagem">

								<p:confirm header="Confirmação"
									message="Deseja realmente excluir o produto #{produto.descricao}?"
									icon="ui-icon-alert" />
								<f:attribute name="selecionadoCorrente" value="#{produto}" />
							</p:commandLink>

							<p:commandLink value="Visualizar" disabled="true" />
						</p:panelGrid>

					</p:column>
				</p:dataTable>
			</h:form>
		</p:panel>
		<h:form>
			<p:confirmDialog global="true" showEffect="fade" hideEffect="fade">
				<p:commandButton value="Sim" type="button"
					styleClass="ui-confirmdialog-yes" icon="ui-icon-check" />
				<p:commandButton value="Não" type="button"
					styleClass="ui-confirmdialog-no" icon="ui-icon-close" />
			</p:confirmDialog>
		</h:form>

		<p:dialog header="Cadastro - Produto" widgetVar="cadastro"
			id="cadastroDialog" modal="true" closable="false" draggable="false"
			hideEffect="fade" responsive="true" resizable="false">

			<h:form id="formCadastro">
				<p:messages id="mensagemCadastro" />
				<h:panelGrid columns="2">
					<p:outputLabel for="descricao" value="Descrição:" />
					<p:inputText id="descricao" size="60" maxlength="100"
						value="#{beanProdutoCRUD.produto.descricao}" required="true"
						requiredMessage="O campo descricao é um campo obrigatório" />

					<p:outputLabel for="quantidade" value="Quantidade:" />
					<p:inputText id="quantidade" size="60" maxlength="7"
						value="#{beanProdutoCRUD.produto.quantidade}" required="true"
						requiredMessage="O campo quantidade é um campo obrigatório"
						converterMessage="Valor incorreto para o campo quantidade"
						validatorMessage="Informe um valor no intervalo 0 e 1000 no campo quantidade">
						<f:validateLongRange minimum="0" maximum="1000" />
					</p:inputText>

					<p:outputLabel for="preco" value="Preço" />
					<p:inputText id="preco" size="60" maxlength="7"
						value="#{beanProdutoCRUD.produto.preco}" required="true"
						requiredMessage="O campo preço é um campo obrigatório"
						converterMessage="Valor incorreto para o campo preço"
						validatorMessage="Informe um valor no intervalo 0,01 e 9999,99 no campo preço">
						<f:validateDoubleRange minimum="0.01" maximum="1000" />
						<f:convertNumber locale="pt_BR" minFractionDigits="2" />
					</p:inputText>

					<p:outputLabel for="fabricante" value="Fabricante:" />
					<p:selectOneMenu id="fabricante" maxlength="30"
						value="#{beanProdutoCRUD.produto.fabricante}"
						converter="omnifaces.SelectItemsConverter" required="true"
						requiredMessage="O campo estado é um campo obrigatório">
						<f:selectItem itemLabel="SELECIONE" />
						<f:selectItems value="#{beanProdutoCRUD.fabricantes}"
							var="fabricante" itemValue="#{fabricante}"
							itemLabel="#{fabricante.descricao}" />
					</p:selectOneMenu>
				</h:panelGrid>

				<h:panelGrid columns="2">
					<p:commandButton value="Salvar"
						actionListener="#{beanProdutoCRUD.salvar()}"
						update=":formCadastro:mensagemCadastro, :formListagem:tableListagem, :formCadastro"
						onsuccess="setTimeout ( '$(\'#formCadastro\\\\:mensagemCadastro\').hide()', 4000);" />
					<p:commandButton value="Cancelar"
						oncomplete="PF('cadastro').hide();" />
				</h:panelGrid>
			</h:form>
		</p:dialog>

		<p:dialog header="Editar - Cidade" widgetVar="edicao"
			id="edicaoDialog" modal="true" closable="false" draggable="false"
			responsive="true" resizable="false">

			<h:form id="formEdicao">
				<p:messages id="mensagemEdicao" />
				<h:panelGrid columns="2">
					<p:outputLabel for="descricao" value="Descrição:" />
					<p:inputText id="descricao" size="60" maxlength="100"
						value="#{beanProdutoCRUD.produto.descricao}" required="true"
						requiredMessage="O campo descricao é um campo obrigatório" />

					<p:outputLabel for="quantidade" value="Quantidade:" />
					<p:inputText id="quantidade" size="60" maxlength="7"
						value="#{beanProdutoCRUD.produto.quantidade}" required="true"
						requiredMessage="O campo quantidade é um campo obrigatório" />

					<p:outputLabel for="preco" value="Preço" />
					<p:inputText id="preco" size="60" maxlength="7"
						value="#{beanProdutoCRUD.produto.preco}" required="true"
						requiredMessage="O campo preço é um campo obrigatório"
						converterMessage="Valor incorreto para o campo preço"
						validatorMessage="Informe um valor no intervalo 0,01 e 9999,99 no campo preço">
						<f:validateDoubleRange minimum="0.01" maximum="1000" />
						<f:convertNumber locale="pt_BR" minFractionDigits="2" />
					</p:inputText>

					<p:outputLabel for="fabricante" value="Fabricante:" />
					<p:selectOneMenu id="fabricante" maxlength="30"
						value="#{beanProdutoCRUD.produto.fabricante}"
						converter="omnifaces.SelectItemsConverter" required="true"
						requiredMessage="O campo estado é um campo obrigatório">
						<f:selectItem noSelectionOption="true" itemLabel="SELECIONE" />
						<f:selectItems value="#{beanProdutoCRUD.fabricantes}"
							var="fabricantes" itemValue="#{fabricantes}"
							itemLabel="#{fabricantes.descricao}" />
					</p:selectOneMenu>
				</h:panelGrid>

				<h:panelGrid columns="2">
					<p:commandButton value="Salvar"
						actionListener="#{beanProdutoCRUD.salvar()}"
						update=":formEdicao:mensagemEdicao, :formListagem:tableListagem, :formEdicao"
						onsuccess="setTimeout ( '$(\'#formEdicao\\\\:mensagemEdicao\').hide()', 4000);" />
					<p:commandButton value="Cancelar" oncomplete="PF('edicao').hide();" />
				</h:panelGrid>
			</h:form>
		</p:dialog>
	</ui:define>
</ui:composition>